webpackJsonp([12],{IzJq:function(t,e){},J6BJ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("n12u");var r={name:"UserItem",props:{user:{type:Object,required:!0}},data:function(){return{}},computed:{isFollow:function(){var t=this.user,e=t.follower,s=void 0!==e&&e,r=t.following,a=void 0!==r&&r;return s&&a?"eachFollow":s?"follow":"unFollow"}},methods:{followUser:function(){var t=this;if(this.loading)return!1;this.loading=!0,this.$store.dispatch("FOLLOW_USER",{id:this.user.id,status:this.isFollow}).then(function(e){var s=e.follower;t.loading=!1,t.user.follower=s}).catch(function(e){var s=e.response;s=void 0===s?{}:s;var r=s.data,a=void 0===r?{message:"操作失败"}:r;t.loading=!1,t.$Message.error(a)})}}},a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-item",attrs:{id:"user-item-"+t.user.id}},[s("v-avatar",{staticClass:"user-item-avatar",attrs:{uid:t.user.id,sex:t.user.sex,src:t.user.avatar}}),s("div",{staticClass:"user-item-info"},[s("p",{staticClass:"user-item-name ellipsis"},[t._v(t._s(t.user.name))]),s("p",{staticClass:"user-item-bio ellipsis"},[t._v(t._s(t.user.bio||"这家伙很懒,什么也没留下"))])]),s("svg",{staticClass:"user-item-follow-icon",on:{click:function(e){e.stopPropagation(),t.followUser(e)}}},[s("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#base-"+t.isFollow}})])],1)},o=[],i=s("XyMi");function n(t){s("vCHx")}var u=!1,l=n,c=null,f=null,h=Object(i["a"])(r,a,o,u,l,c,f),d=h.exports,v={name:"UserFans",components:{UserItem:d},data:function(){return{userList:[],refreshData:[]}},computed:{userID:function(){return this.$route.params.userID},type:function(){var t=this.$route.query.type;return t||"followers"}},watch:{type:function(){this.userList=[],this.$refs.loadmore.beforeRefresh()},refreshData:function(t){t.length>0&&(this.userList=Object.assign([],this.userList,t))}},methods:{navTo:function(t){return{path:"/user/".concat(this.userID,"/fans"),query:{type:t}}},onRefresh:function(){var t=this;this.refreshData=[],this.$http.get("/users/".concat(this.userID,"/").concat(this.type)).then(function(e){var s=e.data,r=void 0===s?[]:s;r.length>0&&(t.refreshData=r),t.$refs.loadmore.topEnd(!(r.length<20))})},onLoadMore:function(){var t=this;this.$http.get("/users/".concat(this.userID,"/").concat(this.type),{params:{limit:15,offset:this.userList.length}}).then(function(e){var s=e.data,r=void 0===s?[]:s;r.length>0&&(t.userList=t.userList.concat(r)),t.$refs.loadmore.bottomEnd(r.length<15)})}}},p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-fans"},[s("head-top",{attrs:{"go-back":!0}},[s("div",{staticClass:"head-top-nav",attrs:{slot:"nav"},slot:"nav"},[s("router-link",{staticClass:"head-top-nav-item",attrs:{exact:"",replace:"",to:t.navTo("followers")}},[t._v("粉丝")]),s("router-link",{staticClass:"head-top-nav-item",attrs:{exact:"",replace:"",to:t.navTo("followings")}},[t._v("关注")])],1)]),s("load-more",{ref:"loadmore",staticClass:"user-fans--list",attrs:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},t._l(t.userList,function(e){return e.id?s("user-item",{key:"user-item-"+e.id,attrs:{user:e}}):t._e()}))],1)},m=[];function w(t){s("IzJq")}var g=!1,_=w,C=null,L=null,b=Object(i["a"])(v,p,m,g,_,C,L);e["default"]=b.exports},vCHx:function(t,e){}});
//# sourceMappingURL=12.b1862532.js.map