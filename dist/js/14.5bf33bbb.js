webpackJsonp([14],{BrJ6:function(t,o,n){"use strict";o["a"]=i,o["c"]=r,o["b"]=c,o["f"]=l,o["e"]=u,o["d"]=d;var e=n("0zyd");function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e["a"].get("/question-topics",{params:t,validateStatus:function(t){return 200===t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a({offset:t,limit:o,follow:n})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e["a"].get("/user/question-topics",{params:t,validateStatus:function(t){return 200===t}})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return s({after:t,limit:o,type:"follow"})}function c(t){return e["a"].put("/user/question-topics/".concat(t),{},{validateStatus:function(t){return 201===t}})}function l(t){return e["a"].delete("/user/question-topics/".concat(t),{validateStatus:function(t){return 204===t}})}function u(t){return e["a"].get("/question-topics/".concat(t),{validateStatus:function(t){return 200===t}})}function d(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:15;return e["a"].get("/question-topics/".concat(t,"/questions"),{params:{type:o,offset:n,limit:a},validateStatus:function(t){return 200===t}})}},ElnR:function(t,o){},M93i:function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var e=n("rzQm"),a=n.n(e),i=n("BrJ6"),s="module-questions-topics",r={name:s,components:{},data:function(){return{topics:[]}},computed:{type:function(){var t=this.$route.query.type,o=void 0===t?"hot":t;return o},loadContainer:function(){return this.$refs.LoadQuestionTopicsContainer},user:function(){var t=this.$store.state.CURRENTUSER;return t}},watch:{type:function(){this.topics=[],this.loadContainer.beforeRefresh()}},methods:{handleRefresh:function(){"follow"!==this.type?this.handleRefreshByAll():this.handleRefreshByFollow()},handleRefreshByAll:function(){var t=this,o=0,n=15;Object(i["a"])(o,n).then(function(o){var e=o.data;t.topics=e,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(e.length<n)}).catch(function(o){var n=o.response;n=void 0===n?{}:n;var e=n.data;t.$Message.error(e),t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0)})},handleRefreshByFollow:function(){var t=this,o=0,n=15;Object(i["c"])(o,n).then(function(o){var e=o.data;t.topics=e,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(e.length<n)}).catch(function(o){var n=o.response;n=void 0===n?{}:n;var e=n.data;t.$Message.error(e),t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0)})},handleLoadMore:function(){"follow"!==this.type?this.handleLoadMoreByAll():this.handleLoadMoreByFollow()},handleLoadMoreByAll:function(){var t=this,o=this.topics.length,n=15;Object(i["a"])(o,n).then(function(o){var e=o.data;t.topics=a()(t.topics).concat(a()(e)),t.loadContainer.bottomEnd(e.length<n)}).catch(function(o){var n=o.response;n=void 0===n?{}:n;var e=n.data;t.loadContainer.bottomEnd(!0),t.$Message.error(e)})},handleLoadMoreByFollow:function(){var t=this,o=this.topisc[this.topics.length].id,n=15;Object(i["c"])(o,n).then(function(o){var e=o.data;t.topics=a()(t.topics).concat(a()(e)),t.loadContainer.bottomEnd(e.length<n)}).catch(function(o){var n=o.response;n=void 0===n?{}:n;var e=n.data;t.loadContainer.bottomEnd(!0),t.$Message.error(e)})},handleFollow:function(t){var o=this;Object(i["b"])(t.id).then(function(){t.has_follow=!0,o.follows_count+=1}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var e=n.data;o.$Message.error(e)})},handleUnfollow:function(t){var o=this;Object(i["f"])(t.id).then(function(){if(t.has_follow=!1,t.follows_count-=1,"follow"===o.type){var n=[];o.topics.forEach(function(o){o.id!==t.id&&n.push(o)}),o.topics=n}}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var e=n.data;o.$Message.error(e)})}}},c=function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{staticClass:"module-questions-topics"},[n("nav",{staticClass:"module-questions-topics-nav"},[n("router-link",{attrs:{to:"/question/topics",replace:"",exact:"","exact-active-class":"active"}},[t._v("全部话题")]),n("router-link",{attrs:{to:{path:"/question/topics",query:{type:"follow"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("我关注的")])],1),n("load-more",{ref:"LoadQuestionTopicsContainer",attrs:{"on-refresh":t.handleRefresh,"on-load-more":t.handleLoadMore}},t._l(t.topics,function(o){return n("div",{key:o.id,staticClass:"module-questions-topics-item"},[n("router-link",{directives:[{name:"show",rawName:"v-show",value:o.avatar,expression:"topic.avatar"}],attrs:{tag:"img",src:o.avatar,to:"/question-topics/"+o.id}}),n("router-link",{staticClass:"title",attrs:{tag:"a",to:"/question-topics/"+o.id}},[n("span",{staticClass:"topic"},[t._v(t._s(o.name))]),n("span",{staticClass:"label"},[n("span",[t._v(t._s(o.follows_count))]),t._v(" 关注\n          ·\n          "),n("span",[t._v(t._s(o.questions_count))]),t._v(" 问题\n        ")])]),o.has_follow||"follow"===t.type?n("button",{staticClass:"follow active",on:{click:function(n){t.handleUnfollow(o)}}},[n("span",[t._v("✓")]),t._v("已关注")]):n("button",{staticClass:"follow",on:{click:function(n){t.handleFollow(o)}}},[n("span",[t._v("+")]),t._v("关注")])],1)}))],1)},l=[],u=n("XyMi");function d(t){n("ElnR")}var f=!1,h=d,v=null,p=null,m=Object(u["a"])(r,c,l,f,h,v,p);o["default"]=m.exports}});
//# sourceMappingURL=14.5bf33bbb.js.map