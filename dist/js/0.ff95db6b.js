webpackJsonp([0],{"5PlU":function(e,t,n){var i=n("RY/4"),o=n("dSzd")("iterator"),s=n("/bQp");e.exports=n("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||s.hasOwnProperty(i(t))}},AT9S:function(e,t){},"NM/j":function(e,t,n){var i=n("vzVI"),o=n("xgqT");function s(e,t){var n=[],i=!0,s=!1,c=void 0;try{for(var r,a=o(e);!(i=(r=a.next()).done);i=!0)if(n.push(r.value),t&&n.length===t)break}catch(e){s=!0,c=e}finally{try{i||null==a["return"]||a["return"]()}finally{if(s)throw c}}return n}function c(e,t){if(Array.isArray(e))return e;if(i(Object(e)))return s(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}e.exports=c},O7VB:function(e,t){},Qdqr:function(e,t){},TWdi:function(e,t){},XZbU:function(e,t,n){"use strict";var i={computed:{text:function(){var e=this.feed.feed_content;return e=!!e&&(e.length<49?e:this.isPay?"".concat(e.slice(0,40)):"".concat(e.slice(0,49),"…")),e},title:function(){return""},hasLike:function(){return this.feed.has_like},likeCount:function(){return this.feed.like_count},viewCount:function(){return this.feed.feed_view_count},commentCount:function(){return this.feed.feed_comment_count}},methods:{viewFeed:function(){this.$router.push("/feed-detail/".concat(this.feed.id))},formatData:function(){console.log("format data")},likeFeed:function(){var e=this,t=this.hasLike?"delete":"post",n=this.hasLike?"/feeds/".concat(this.feed.id,"/unlike"):"/feeds/".concat(this.feed.id,"/like"),i=this.hasLike?this.feed.like_count-1:this.feed.like_count+1;this.$http({url:n,method:t}).then(function(){e.feed.has_like=!e.feed.has_like,e.feed.like_count=i}).catch(function(e){console.log(e)})},moreAction:function(){console.log("更多操作")},commentFeed:function(e,t,n){var i=this;this.$http.post("/feeds/".concat(this.feed.id,"/comments"),{body:e,reply_user:t}).then(function(e){var t=e.data;t=void 0===t?{}:t;var o=t.comment;i.feed.comments.unshift(o),i.feed.feed_comment_count+=1,n&&n()}).catch(function(e){var t=e.response;t=void 0===t?{}:t;var o=t.data,s=void 0===o?{message:"评论失败"}:o;i.$Message.error(s),n&&n()})},deleteComment:function(e){console.log("删除评论:",e)},pinnedComment:function(e){console.log("申请评论置顶:",e)}}},o={computed:{text:function(){return this.feed.summary},title:function(){return this.feed.title},hasLike:function(){return this.feed.liked},likeCount:function(){return this.feed.likes_count},viewCount:function(){return this.feed.views_count},commentCount:function(){return this.feed.comments_count}},methods:{viewFeed:function(){this.$router.push("/group/".concat(this.feed.group_id,"/feed/").concat(this.feed.id))},formatData:function(){console.log("format data")},likeFeed:function(){var e=this,t=this.hasLike?"delete":"post",n=this.hasLike?this.feed.likes_count-1:this.feed.likes_count+1;this.$http({method:t,url:"/plus-group/group-posts/".concat(this.feed.id,"/likes")}).then(function(){e.feed.liked=!e.feed.liked,e.feed.likes_count=n}).catch(function(e){console.log(e)})},moreAction:function(){console.log("更多操作")},commentFeed:function(e,t,n){var i=this;this.$http.post("/plus-group/group-posts/".concat(this.feed.id,"/comments"),{body:e,reply_user:t}).then(function(e){var t=e.data;t=void 0===t?{}:t;var o=t.comment;i.feed.comments.unshift(o),i.feed.comments_count+=1,n&&n()}).catch(function(e){var t=e.response;t=void 0===t?{}:t;var o=t.data,s=void 0===o?{message:"评论失败"}:o;i.$Message.error(s),n&&n()})},deleteComment:function(e){console.log("删除评论:",e)},pinnedComment:function(e){console.log("申请评论置顶:",e)}}},s=(n("VjuZ"),n("n12u"),{validator:function(e){return"number"===typeof+e}}),c={name:"feedTool",props:{hasLike:{type:Boolean,required:!0},likeCount:Object.assign({type:[Number,String],required:!0},s),viewCount:Object.assign({type:[Number,String],required:!0},s),commentCount:Object.assign({type:[Number,String],required:!0},s)},methods:{likeFeed:function(){this.$emit("likeFeed")},commentFeed:function(){this.$emit("commentFeed",this.com)},moreAction:function(){this.$emit("moreAction")}}},r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"feed-tool"},[n("div",{staticClass:"feed-tool-item",class:{hasLike:e.hasLike},on:{click:function(t){t.stopPropagation(),e.likeFeed(t)}}},[n("v-icon",{staticClass:"feed-tool-icon",attrs:{type:e.hasLike?"feed-like":"feed-unlike"}}),n("span",[e._v(e._s(e.likeCount))])],1),n("div",{staticClass:"feed-tool-item",on:{click:function(t){t.stopPropagation(),e.commentFeed(t)}}},[n("v-icon",{staticClass:"feed-tool-icon",attrs:{type:"feed-comment"}}),n("span",[e._v(e._s(e.commentCount))])],1),n("div",{staticClass:"feed-tool-item"},[n("v-icon",{staticClass:"feed-tool-icon",attrs:{type:"feed-eye"}}),n("span",[e._v(e._s(e.viewCount))])],1),n("div",{staticClass:"feed-tool-item",on:{click:function(t){t.stopPropagation(),e.moreAction(t)}}},[n("v-icon",{staticClass:"feed-tool-icon",attrs:{type:"feed-more"}})],1)])},a=[],u=n("XyMi");function l(e){n("uuna")}var d=!1,f=l,m="data-v-d56bde0e",h=null,p=Object(u["a"])(c,r,a,d,f,m,h),v=p.exports,g=(n("mJx5"),n("NM/j")),_=n.n(g),k=n("14gb"),y={name:"m-pics",props:{id:{type:Number,required:!0},pics:{type:Array}},methods:{handleClick:function(e,t){var n=this.$el.querySelectorAll(".m-pic"),i=this.pics.map(function(e,t){return Object.assign({},e,{el:n[t]})});k["a"].$emit("mvGallery",t,i)},isLongImg:function(e){var t=e.size.split("x"),n=_()(t,2),i=n[0],o=n[1];return e.title="查看原图",e.src="/api/v2/files/".concat(e.file),e.w=i,e.h=o,i>3*o||o>3*i},longStyle:function(e,t){return e=e>518?518:e,t=t>960?960:t,{width:e+"px",paddingBottom:t/e*100+"%"}}}},C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["m-pics","m-pics-"+e.pics.length],attrs:{id:"m-pics"+e.id}},[n("ul",{staticClass:"m-pics-list"},e._l(e.pics,function(t,i){return n("li",{key:"pics-"+e.id+"-"+i},[n("div",{class:["m-pics-box",{long:e.isLongImg(t)}],style:1===e.pics.length?e.longStyle(t.w,t.h):""},[n("div",{staticClass:"m-pic",style:{backgroundImage:"url("+t.src+")"},on:{click:function(t){t.stopPropagation(),e.handleClick(t,i)}}})])])}))])},x=[];function b(e){n("Qdqr")}var w=!1,$=b,P=null,F=null,S=Object(u["a"])(y,C,x,w,$,P,F),A=S.exports,O=(n("EuXz"),{name:"feedCommentItem",props:{comment:{required:!0}},computed:{user:function(){var e=this.comment.user;if(e)return e},replyUser:function(){var e=this.comment.reply;return e},body:function(){var e=this.comment.body;return e.length>60?e.slice(0,57)+"…":e}},methods:{to:function(e){this.$router.push({path:e})},commentAction:function(){this.$emit("action",this.user.id,this.user.name,this.comment.id)}},mounted:function(){this.user.id&&this.$store.commit("SAVE_USER",this.user)}}),U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.user.id?n("div",{staticClass:"feed-comment-item",on:{click:function(t){t.stopPropagation(),e.commentAction(t)}}},[n("a",{staticClass:"user-name",on:{click:function(t){t.stopPropagation(),e.to("/user/"+e.user.id)}}},[e._v(e._s(e.user.name))]),e.replyUser?[e._v("\n    回复\n    "),n("a",{staticClass:"user-name",on:{click:function(t){t.stopPropagation(),e.to("/user/"+e.replyUser.id)}}},[e._v(e._s(e.replyUser.name))])]:e._e(),n("span",{staticClass:"content"},[e._v(e._s(e.body))])],2):e._e()},E=[];function I(e){n("TWdi")}var j=!1,z=I,L=null,N=null,R=Object(u["a"])(O,U,E,j,z,L,N),T=R.exports,q=n("ZoQJ"),B=["feed","group"],M={feed:{required:!0},channel:{validator:function(e){return Object(q["f"])(e,B)}},showFeedTime:{type:Boolean,default:!1},isPinned:{type:Boolean,default:!1},isPay:{type:Boolean,default:!1}},Q={feedTools:v,feedImages:A,feedCommentItem:T},V={viewUser:function(){this.$router.push("/user/".concat(this.feed.user_id))},viewPic:function(){console.log("查看图片")},commentAction:function(e,t,n){if(e===this.$store.state.CURRENTUSER.id)this.showCommentAction(n);else{var i=t&&e?"回复".concat(t):"随便说说";this.showCommentInput({placeholder:i,reply_user:e})}},showCommentAction:function(e){var t=this;this.$Modal.info({render:function(n){var i=this;return n("div",{},[n("button",{on:{click:function(){t.deleteComment(e,i.onOk)}}},"删除"),n("button",{on:{click:function(){t.pinnedComment(e,i.onOk)}}},"申请评论置顶")])},onOk:function(){this.$Modal.remove()}})},showCommentInput:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=e,i=n.reply_user;e=Object.assign({},{onOk:function(e){t.commentFeed(e,i,function(){t.$Modal.remove()})}},e),this.$Modal.commentInpt(e)}},X={user:function(){return this.feed.user},time:function(){return this.feed.created_at.replace(/-/g,"/")},images:function(){return this.feed.images||[]},comments:function(){return this.feed.comments||[]},isOwner:function(){return this.user.id===this.$store.state.CURRENTUSER.id}},J={props:M,computed:X,components:Q,methods:V},K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"feed-item",on:{click:e.viewFeed}},[e.showFeedTime?n("span",[e._v(e._s(e._f("time2txt")(e.time)))]):n("v-avatar",{staticClass:"feed-item-avatar",attrs:{sex:e.user.sex,src:e.user.avatar},nativeOn:{click:function(t){t.stopPropagation(),e.viewUser(t)}}}),n("div",{staticClass:"feed-item-content"},[e.showFeedTime?e._e():n("div",{staticClass:"feed-item-content-info"},[n("span",{on:{click:function(t){t.stopPropagation(),e.viewUser(t)}}},[e._v(e._s(e.user.name))]),n("div",[e.isPinned?n("i",{staticClass:"feed-item-content-info-pinned-icon"},[e._v("置顶")]):e._e(),[n("span",{staticClass:"feed-item-content-info-time"},[e._v("\n                        "+e._s(e._f("time2tips")(e.time))+"\n                    ")])]],2)]),e.title?[n("div",{staticClass:"feed-item-content-title"},[e._v(e._s(e.title))])]:e._e(),e.text?[n("div",{staticClass:"feed-item-content-text"},[n("span",[e._v(e._s(e.text))]),e.isPay?n("span",{staticClass:"blur"},[e._v(e._s("魑魅魍魉魑魅魍魉魑魅"))]):e._e()])]:e._e(),e.images.length>0?[n("feed-images",{staticClass:"feed-item-content-imgs",attrs:{pics:e.images,id:e.feed.id},on:{viewPic:e.viewPic}})]:e._e()],2),n("div",{staticClass:"feed-item-foot"},[n("feed-tools",{attrs:{hasLike:e.hasLike,likeCount:e.likeCount,viewCount:e.viewCount,commentCount:e.commentCount},on:{likeFeed:e.likeFeed,moreAction:e.moreAction,commentFeed:e.showCommentInput}})],1),e.commentCount?[n("div",{staticClass:"feed-item-comments"},[e._l(e.comments.slice(0,5),function(t){return t.id?n("feed-comment-item",{key:t.id,attrs:{comment:t},on:{action:e.commentAction}}):e._e()}),e.commentCount>5?n("a",{on:{click:e.viewFeed}},[e._v("查看更多")]):e._e()],2)]:e._e()],2)},D=[],Z=!1,G=null,W=null,Y=null,H=Object(u["a"])(J,K,D,Z,G,W,Y),ee=H.exports;n("O7VB");n.d(t,"a",function(){return te}),n.d(t,"b",function(){return ne});var te={extends:ee,name:"FeedItem",mixins:[i]},ne={extends:ee,name:"GroupFeedItem",mixins:[o]}},Xd32:function(e,t,n){n("+tPU"),n("zQR9"),e.exports=n("5PlU")},fxRn:function(e,t,n){n("+tPU"),n("zQR9"),e.exports=n("g8Ux")},g8Ux:function(e,t,n){var i=n("77Pl"),o=n("3fs2");e.exports=n("FeBl").getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},mJx5:function(e,t,n){n("Vg1y")("split",2,function(e,t,i){"use strict";var o=n("u0PK"),s=i,c=[].push,r="split",a="length",u="lastIndex";if("c"=="abbc"[r](/(b)*/)[1]||4!="test"[r](/(?:)/,-1)[a]||2!="ab"[r](/(?:ab)*/)[a]||4!="."[r](/(.?)(.?)/)[a]||"."[r](/()()/)[a]>1||""[r](/.?/)[a]){var l=void 0===/()??/.exec("")[1];i=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!o(e))return s.call(n,e,t);var i,r,d,f,m,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),v=0,g=void 0===t?4294967295:t>>>0,_=new RegExp(e.source,p+"g");l||(i=new RegExp("^"+_.source+"$(?!\\s)",p));while(r=_.exec(n)){if(d=r.index+r[0][a],d>v&&(h.push(n.slice(v,r.index)),!l&&r[a]>1&&r[0].replace(i,function(){for(m=1;m<arguments[a]-2;m++)void 0===arguments[m]&&(r[m]=void 0)}),r[a]>1&&r.index<n[a]&&c.apply(h,r.slice(1)),f=r[0][a],v=d,h[a]>=g))break;_[u]===r.index&&_[u]++}return v===n[a]?!f&&_.test("")||h.push(""):h.push(n.slice(v)),h[a]>g?h.slice(0,g):h}}else"0"[r](void 0,0)[a]&&(i=function(e,t){return void 0===e&&0===t?[]:s.call(this,e,t)});return[function(n,o){var s=e(this),c=void 0==n?void 0:n[t];return void 0!==c?c.call(n,s,o):i.call(String(s),n,o)},i]})},"mfU/":function(e,t,n){"use strict";var i=n("fKPv"),o=n.n(i),s=(n("EuXz"),n("rzQm")),c=n.n(s),r={name:"module-avatar",props:{classes:{type:[Array,String]},size:{type:[String,Number],default:.4},sizeUnit:{type:String,default:"rem"}},methods:{classNameBuilder:function(e){return"module-avatar-".concat(e)},handleClick:function(e){this.$emit("click",e)}},computed:{rootClassName:function(){var e=this.classes||[];return("string"===typeof e||e instanceof String)&&(e=[e]),["module-avatar"].concat(c()(e))},rootStyles:function(){var e=this.size;return("number"===typeof e||e instanceof Number)&&(e+=this.sizeUnit),{width:e,height:e}}}},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._b({class:e.rootClassName,style:e.rootStyles,on:{click:e.handleClick}},"div",e.$props,!1),[e._t("default")],2)},u=[],l=n("XyMi");function d(e){n("AT9S")}var f=!1,m=d,h=null,p=null,v=Object(l["a"])(r,a,u,f,m,h,p),g=v.exports,_={name:"module-user-avatar",props:{src:String,sex:{type:Number,default:0},anonymity:{type:Boolean,default:!1},classes:{type:[Array,String]},size:{type:[String,Number],default:.4},sizeUnit:{type:String,default:"rem"}},components:o()({},g.name,g),computed:{defaultAvatar:function(){switch(this.sex){case 1:return"#avatar-man";case 2:return"#avatar-woman";case 0:default:return"#avatar-secret"}}},methods:{handleClick:function(e){this.$emit("click",e)}}},k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("module-avatar",e._b({nativeOn:{click:function(t){e.handleClick(t)}}},"module-avatar",e.$props,!1),[e.anonymity?[e._v("匿")]:e.src?n("img",{attrs:{src:e.src}}):n("svg",{staticClass:"avatar_icon",attrs:{width:"100%",height:"100%"}},[n("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":e.defaultAvatar}})])],2)},y=[],C=!1,x=null,b=null,w=null,$=Object(l["a"])(_,k,y,C,x,b,w);t["a"]=$.exports},u0PK:function(e,t,n){var i=n("UKM+"),o=n("ydD5"),s=n("kkCw")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==o(e))}},uuna:function(e,t){},vzVI:function(e,t,n){e.exports=n("Xd32")},xgqT:function(e,t,n){e.exports=n("fxRn")}});
//# sourceMappingURL=0.ff95db6b.js.map