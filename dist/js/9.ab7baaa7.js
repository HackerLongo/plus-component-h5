webpackJsonp([9],{"860e":function(t,e,n){"use strict";var s=n("fKPv"),a=n.n(s),o=(n("EuXz"),n("mfU/")),i=n("BM2P"),r="module-question-list-answer-card",u={name:r,components:a()({},o["a"].name,o["a"]),props:{answer:{required:!0,validator:function(t){return!t||t instanceof Object}}},computed:{anonymity:function(){var t=this.answer.anonymity;return!!t},user:function(){var t=this.answer.user;return t||{}},showUsername:function(){return this.anonymity?"匿名用户":this.user.name},body:function(){var t=this.answer.body;return Object(i["syntaxTextAndImage"])(t||"").text}}},c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.answer?n("div",{staticClass:"module-question-list-answer-card"},[n("module-user-avatar",{attrs:{anonymity:t.anonymity,src:t.user.avatar,sex:t.user.sex}}),t._v("\n  "+t._s(t.showUsername)+"："+t._s(t.body)+"\n")],1):n("div",{staticClass:"module-question-list-answer-card-empty"})},l=[],d=n("XyMi");function p(t){n("fAxL")}var v,f=!1,h=p,m=null,y=null,q=Object(d["a"])(u,c,l,f,h,m,y),_=q.exports,g={name:"module-question-list-item",components:(v={},a()(v,o["a"].name,o["a"]),a()(v,_.name,_),v),props:{question:{type:Object,required:!0}},computed:{answer:function(){var t=this.question.answer;return t},body:function(){return Object(i["syntaxTextAndImage"])(this.question.body)},firstImageStyle:function(){var t=this.body.images,e=t.pop();return!!e&&"background-image: url(".concat(e,")")}}},w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"module-question-list-item"},[n("router-link",{staticClass:"module-question-list-item_title",attrs:{tag:"h3",to:"/questions/"+t.question.id}},[t._v("\n    "+t._s(t.question.subject)+"\n    "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.excellent,expression:"question.excellent"}],staticClass:"module-question-list-item-shang-i"},[t._v("精")])]),t.firstImageStyle?n("router-link",{staticClass:"module-question-list-item_image",style:t.firstImageStyle,attrs:{tag:"div",to:"/questions/"+t.question.id}}):t._e(),n("module-question-list-answer-card",{attrs:{answer:t.answer}}),n("router-link",{staticClass:"module-question-list-item_button",attrs:{to:"/questions/"+t.question.id,tag:"div"}},[n("span",[n("span",{staticClass:"module-question-list-item_button-style1"},[t._v(t._s(t.question.watchers_count))]),t._v(" 关注\n    ")]),n("span",[n("span",[t._v("·")]),n("span",{staticClass:"module-question-list-item_button-style1"},[t._v(t._s(t.question.answers_count))]),t._v(" 回答\n    ")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.amount,expression:"question.amount"}]},[n("span",[t._v("·")]),n("span",{staticClass:"module-question-list-item-shang"},[n("span",[t._v("赏")]),t._v("\n        "+t._s(t.question.amount)+"\n      ")])]),n("span",{staticClass:"module-question-list-item_button-time"},[t._v(t._s(t._f("time2tips")(t.question.updated_at)))])])],1)},b=[];function x(t){n("KJpw")}var C=!1,k=x,O=null,j=null,E=Object(d["a"])(g,w,b,C,k,O,j);e["a"]=E.exports},BrJ6:function(t,e,n){"use strict";e["a"]=o,e["c"]=r,e["b"]=u,e["f"]=c,e["e"]=l,e["d"]=d;var s=n("0zyd");function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s["a"].get("/question-topics",{params:t,validateStatus:function(t){return 200===t}})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a({offset:t,limit:e,follow:n})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s["a"].get("/user/question-topics",{params:t,validateStatus:function(t){return 200===t}})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return i({after:t,limit:e,type:"follow"})}function u(t){return s["a"].put("/user/question-topics/".concat(t),{},{validateStatus:function(t){return 201===t}})}function c(t){return s["a"].delete("/user/question-topics/".concat(t),{validateStatus:function(t){return 204===t}})}function l(t){return s["a"].get("/question-topics/".concat(t),{validateStatus:function(t){return 200===t}})}function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:15;return s["a"].get("/question-topics/".concat(t,"/questions"),{params:{type:e,offset:n,limit:a},validateStatus:function(t){return 200===t}})}},HyuL:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("rzQm"),a=n.n(s),o=n("mfU/"),i=n("860e"),r=n("BrJ6"),u="page-question-topic",c={name:u,components:{"user-avatar":o["a"],"question-item":i["a"]},data:function(){return{topic:{},loading:!0,questions:[],typeNavOffsetTop:0}},computed:{id:function(){return this.$route.params.id},type:function(){var t=this.$route.query.type,e=void 0===t?"hot":t;return e},loadContainer:function(){return this.$refs.load}},watch:{$route:function(t,e){console.log(t.path===e.path&&t.query.type!==e.query.type),t.path===e.path&&t.query.type!==e.query.type&&(this.questions=[],this.loadContainer.beforeRefresh())}},methods:{classNameBuilder:function(t){return"".concat(u,"-").concat(t)},handleRefresh:function(){var t=this;Object(r["e"])(this.id).then(function(e){var n=e.data;t.loading=!1,t.topic=n,t.handleRefreshQuestions()}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loading=!0,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0),t.$Message.error(s)})},handleRefreshQuestions:function(){var t=this,e=0,n=15;Object(r["d"])(this.id,this.type,e,n).then(function(e){var s=e.data;t.questions=s,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0),t.$Message.error(s)})},handleLoadQuestions:function(){var t=this,e=this.questions.length,n=15;Object(r["d"])(this.id,this.type,e,n).then(function(e){var s=e.data;t.questions=a()(t.questions).concat(a()(s)),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loadContainer.bottomEnd(!0),t.$Message.error(s)})},handleScrolling:function(){var t=this.$refs.types,e=this.typeNavOffsetTop,n=document.documentElement.scrollTop+48;if(n>=e)return t.style.position="fixed",t.style.marginTop=0,void(t.style.top="0.9rem");t.style.position="relative",t.style.marginTop="-1rem",t.style.top="1.16rem"},handleFollow:function(t){var e=this;Object(r["b"])(t.id).then(function(){t.has_follow=!0,e.follows_count+=1}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var s=n.data;e.$Message.error(s)})},handleUnfollow:function(t){var e=this;Object(r["f"])(t.id).then(function(){if(t.has_follow=!1,t.follows_count-=1,"follow"===e.type){var n=[];e.topics.forEach(function(e){e.id!==t.id&&n.push(e)}),e.topics=n}}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var s=n.data;e.$Message.error(s)})}},mounted:function(){var t=this;this.typeNavOffsetTop=this.$refs.types.offsetTop,this.loadContainer.onLoadMore instanceof Function||(document.onscroll=function(){t.handleScrolling()})}},l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("head-top",{attrs:{title:t.topic.name||"话题详情","go-back":!0,append:!0}},[n("button",{class:t.classNameBuilder("share"),attrs:{slot:"append"},slot:"append"},[n("svg",{staticClass:"icon"},[n("use",{attrs:{"xlink:href":"#base-share"}})])])]),n("div"),n("div",{class:t.classNameBuilder("topic")},[n("img",{attrs:{src:"https://images.zhibocloud.cn/question/topics/000/000/000/02.png"}}),n("div",{staticClass:"title"},[n("h3",{staticClass:"topic"},[t._v(t._s(t.topic.name))]),n("span",{staticClass:"label"},[n("span",[t._v(t._s(t.topic.follows_count))]),t._v(" 关注\n          ·\n          "),n("span",[t._v(t._s(t.topic.questions_count))]),t._v(" 问题\n        ")])]),t.topic.has_follow?n("button",{staticClass:"follow active",on:{click:function(e){t.handleUnfollow(t.topic)}}},[n("span",[t._v("✓")]),t._v("已关注\n    ")]):n("button",{staticClass:"follow",on:{click:function(e){t.handleFollow(t.topic)}}},[n("span",[t._v("+")]),t._v("关注\n    ")])]),n("div",{class:t.classNameBuilder("topic-desc")},[t._v("\n    话题简介："+t._s(t.topic.description)+"\n  ")]),n("div",{class:t.classNameBuilder("experts")},[n("span",[t._v(t._s(t.topic.experts_count)+"位相关专家")]),n("div",t._l(t.topic.experts,function(e,s){return n("user-avatar",{key:e.id,class:t.classNameBuilder("experts-user"),style:[{zIndex:t.topic.experts.length-s}],attrs:{size:.5,src:e.avatar,sex:e.sex}})}))]),n("nav",{ref:"types",class:t.classNameBuilder("types")},[n("router-link",{attrs:{to:{path:"/question-topics/"+t.id},replace:"",exact:"","exact-active-class":"active"}},[t._v("热门")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"excellent"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("精选")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"reward"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("悬赏")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"new"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("最新")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"all"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("全部")])],1),n("load-more",{ref:"load",class:[t.classNameBuilder("questions")],attrs:{"on-refresh":t.handleRefresh,"on-load-more":t.handleLoadQuestions,scrolling:t.handleScrolling}},t._l(t.questions,function(t){return n("question-item",{key:t.id,attrs:{question:t}})}))],1)},d=[],p=n("XyMi");function v(t){n("UXKy")}var f=!1,h=v,m=null,y=null,q=Object(p["a"])(c,l,d,f,h,m,y);e["default"]=q.exports},KJpw:function(t,e){},UXKy:function(t,e){},fAxL:function(t,e){}});
//# sourceMappingURL=9.ab7baaa7.js.map